---
layout: post
title:  "GNOME (Linux) で Canon MG7730 に印刷したい"
date:   2024-10-27 09:00:08 +0900
categories: デバイス
tags:
- MacBook
- OpenSUSE
- cups
- プリンター
- MG7730
---
### 事象
OpenSUSE から印刷をできるようにします。使用するプリンターは [Canon MG7730][mg7730]。USB 接続ではなく、ネットワーク接続にしています。

### 対策
まず、キヤノンのサイトからドライバをダウンロードします。上記の Web サイトから「ソフトウェアダウンロード」＞「Linux」＞「IJ Printer Driver Ver 5.20 for Linux」と開きます。使用許諾を確認した上で、パッケージが rpm と deb があるので、今回は rpm をダウンロードします。

![http download][img01]

ダウンロードした .tar.gz ファイルを展開します。root 権限でコンソールを開き、`install.sh` を実行します。

![install][img02]

上図は一度実行済みなので、rpm パッケージがインストール済みである旨のメッセージが表示されていますが、流れは変わらないです。パッケージのインストールが終わると、プリンタの検出に移ります。Enter 入力待ちになるので、プリンターの電源をオンにし、ネットワークに接続したら `Enter` キーを押します。

接続方法の選択では、今回はネットワーク接続なので `2` を入力し、`Enter` キーを押します。ここでプリンターが検出されるはずですが、今回はプリンターが検出できないと表示されました。

これは、ファイアウォールで通信がブロックされたためと思われます。そのため、

`systemctl stop firewalld`

で一旦ファイアウォールを停止します。そのうえで、インストールスクリプトへ戻り、`Enter` キーを押してプリンタの再検出を行います。

![mg7730][img03]

これでプリンターが検出されました。必要であればプリンターに名前をつけて (デフォルトで「MG7700LAN」という名前がつけられます) 登録します。

`インストールが完了しました` と表示されたら完了です。以下のコマンドを実行して、無効にしたファイアウォールを有効にします。

`systemctl start firewalld`

### 印刷
GNOME のアプリ一覧から「印刷設定」を開くと、登録した `MG7700LAN` があることがわかります。

![print settings][img04]

アプリケーションから印刷する際には、以下のようにプリンター選択画面で `MG7700LAN` を選択します。両面印刷や白黒印刷もこの画面から指定可能です。

![print windows][img05]

### ファイアウォールの設定
この状態だと、おそらく印刷できません。印刷の際も、ファイアウォールによって通信がブロックされてしまうようです。ファイアウォールを止めれば印刷できますが、必要な通信を許可することでファイアウォールは動作したまま、印刷も可能でした。

「yast2」＞「セキュリティとユーザ」＞「ファイアウォール」を開きます。「ゾーン」で適用されているゾーン (デフォルトだと「public」) を選択し、「サービス」の「既知」欄から `ipp` を選択し、「追加」をクリックします。

![ipp][img06]

以下のように「許可済み」欄に `ipp` がセットされたら「了解」をクリックします。

![allow ipp][img07]

これでプリンターへ印刷できると思います。


[mg7730]:https://canon.jp/support/products?pr=3806

[img01]:/assets/images/2024/10/ss-20241027-01.png
[img02]:/assets/images/2024/10/ss-20241027-02.png
[img03]:/assets/images/2024/10/ss-20241027-03.png
[img04]:/assets/images/2024/10/ss-20241027-04.png
[img05]:/assets/images/2024/10/ss-20241027-05.png
[img06]:/assets/images/2024/10/ss-20241027-06.png
[img07]:/assets/images/2024/10/ss-20241027-07.png
